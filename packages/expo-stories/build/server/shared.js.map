{"version":3,"file":"shared.js","sourceRoot":"","sources":["../../server/shared.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,8CAAwB;AAIX,QAAA,eAAe,GAAG,uBAAuB,CAAC;AAE1C,QAAA,aAAa,GAAiB;IACzC,WAAW,EAAE,OAAO,CAAC,GAAG,EAAE;IAC1B,SAAS,EAAE,OAAO,CAAC,GAAG,EAAE;IACxB,2BAA2B;IAC3B,IAAI,EAAE,QAAQ,OAAC,OAAO,CAAC,GAAG,CAAC,IAAI,mCAAI,MAAM,CAAC;CAC3C,CAAC;AAEF,SAAgB,YAAY,CAAC,YAA0B;;IACrD,IAAI,MAAM,yBACL,qBAAa,GACb,YAAY,CAChB,CAAC;IAEF,IAAM,iBAAiB,GAAG,cAAI,CAAC,OAAO,CAAC,MAAM,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;IAC3E,IAAM,WAAW,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC;IAC/C,IAAM,iBAAiB,SAAG,WAAW,CAAC,WAAW,mCAAI,EAAE,CAAC;IAExD,MAAM,yBACD,MAAM,GACN,iBAAiB,CACrB,CAAC;IAEF,OAAO,MAAM,CAAC;AAChB,CAAC;AAhBD,oCAgBC;AAED,SAAgB,mBAAmB,CAAC,MAAoB;IACtD,IAAM,gBAAgB,GAAG,cAAI,CAAC,OAAO,CAAC,MAAM,CAAC,WAAW,EAAE,uBAAe,EAAE,oBAAoB,CAAC,CAAC;IACjG,OAAO,gBAAgB,CAAC;AAC1B,CAAC;AAHD,kDAGC;AAED,SAAgB,gBAAgB,CAAC,MAAoB;IACnD,IAAM,gBAAgB,GAAG,mBAAmB,CAAC,MAAM,CAAC,CAAC;IACrD,IAAM,aAAa,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;IAChD,OAAO,aAAa,CAAC;AACvB,CAAC;AAJD,4CAIC;AAED,SAAgB,UAAU,CAAC,MAAoB;IAC7C,IAAM,aAAa,GAAG,gBAAgB,CAAC,MAAM,CAAC,CAAC;IAC/C,IAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,UAAA,GAAG;QACtD,OAAO,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,OAAO,OAAO,CAAC;AACjB,CAAC;AAPD,gCAOC;AAED,SAAgB,kBAAkB,CAAC,MAAoB;IACrD,IAAM,UAAU,GAAG,cAAI,CAAC,OAAO,CAAC,MAAM,CAAC,WAAW,EAAE,uBAAe,CAAC,CAAC;IACrE,OAAO,UAAU,CAAC;AACpB,CAAC;AAHD,gDAGC;AAED,SAAgB,cAAc,CAAC,MAAoB;IACjD,IAAM,UAAU,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC;IAC9C,IAAM,SAAS,GAAG,cAAI,CAAC,OAAO,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC;IACzD,OAAO,SAAS,CAAC;AACnB,CAAC;AAJD,wCAIC","sourcesContent":["import path from 'path';\n\nimport { ServerConfig } from '../types';\n\nexport const STORY_CACHE_DIR = '__generated__/stories';\n\nexport const defaultConfig: ServerConfig = {\n  projectRoot: process.cwd(),\n  watchRoot: process.cwd(),\n  // eslint-disable-next-line\n  port: parseInt(process.env.PORT ?? '7001'),\n};\n\nexport function mergeConfigs(serverConfig: ServerConfig): ServerConfig {\n  let config = {\n    ...defaultConfig,\n    ...serverConfig,\n  };\n\n  const pathToPackageJson = path.resolve(config.projectRoot, 'package.json');\n  const packageJson = require(pathToPackageJson);\n  const packageJsonConfig = packageJson.expoStories ?? {};\n\n  config = {\n    ...config,\n    ...packageJsonConfig,\n  };\n\n  return config;\n}\n\nexport function getManifestFilePath(config: ServerConfig) {\n  const manifestFilePath = path.resolve(config.projectRoot, STORY_CACHE_DIR, 'storyManifest.json');\n  return manifestFilePath;\n}\n\nexport function getStoryManifest(config: ServerConfig) {\n  const manifestFilePath = getManifestFilePath(config);\n  const storyManifest = require(manifestFilePath);\n  return storyManifest;\n}\n\nexport function getStories(config: ServerConfig) {\n  const storyManifest = getStoryManifest(config);\n  const stories = Object.keys(storyManifest.files).map(key => {\n    return storyManifest.files[key];\n  });\n\n  return stories;\n}\n\nexport function getStoriesCacheDir(config: ServerConfig) {\n  const storiesDir = path.resolve(config.projectRoot, STORY_CACHE_DIR);\n  return storiesDir;\n}\n\nexport function getStoriesFile(config: ServerConfig) {\n  const storiesDir = getStoriesCacheDir(config);\n  const storyFile = path.resolve(storiesDir, 'stories.js');\n  return storyFile;\n}\n"]}