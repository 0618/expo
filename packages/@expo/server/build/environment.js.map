{"version":3,"file":"environment.js","names":["installGlobals","global","fetch","Blob","Body","Headers","HeaderInit","HeadersInit","Request","Response","ExpoResponse","BodyInit","json","data","undefined","init","body","JSON","stringify","TypeError","headers","has","set"],"sources":["../src/environment.ts"],"sourcesContent":["import fetch, {\n  Blob,\n  Body,\n  BodyInit,\n  HeaderInit,\n  Headers,\n  HeadersInit,\n  Request,\n  Response,\n} from 'node-fetch';\n\n// Ensure these are available for the API Routes.\nexport function installGlobals() {\n  // @ts-expect-error\n  global.fetch = fetch;\n  // @ts-expect-error\n  global.Blob = Blob;\n  // @ts-expect-error\n  global.Body = Body;\n  // @ts-expect-error\n  global.Headers = Headers;\n\n  // @ts-expect-error\n  global.HeaderInit = HeaderInit;\n  // @ts-expect-error\n  global.HeadersInit = HeadersInit;\n  // @ts-expect-error\n  global.Request = Request;\n  // @ts-expect-error\n  global.Response = ExpoResponse;\n  // @ts-expect-error\n  global.BodyInit = BodyInit;\n}\n\nexport class ExpoResponse extends Response {\n  // TODO: Drop when we upgrade to node-fetch v3\n  static json(data: any = undefined, init: ResponseInit = {}): ExpoResponse {\n    const body = JSON.stringify(data);\n\n    if (body === undefined) {\n      throw new TypeError('data is not JSON serializable');\n    }\n\n    // @ts-expect-error\n    const headers = new Headers(init?.headers);\n\n    if (!headers.has('content-type')) {\n      headers.set('content-type', 'application/json');\n    }\n\n    return new ExpoResponse(body, {\n      ...init,\n      headers,\n    });\n  }\n}\n"],"mappings":";;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AASoB;AAAA;AAEpB;AACO,SAASA,cAAc,GAAG;EAC/B;EACAC,MAAM,CAACC,KAAK,GAAGA,oBAAK;EACpB;EACAD,MAAM,CAACE,IAAI,GAAGA,iBAAI;EAClB;EACAF,MAAM,CAACG,IAAI,GAAGA,iBAAI;EAClB;EACAH,MAAM,CAACI,OAAO,GAAGA,oBAAO;;EAExB;EACAJ,MAAM,CAACK,UAAU,GAAGA,uBAAU;EAC9B;EACAL,MAAM,CAACM,WAAW,GAAGA,wBAAW;EAChC;EACAN,MAAM,CAACO,OAAO,GAAGA,oBAAO;EACxB;EACAP,MAAM,CAACQ,QAAQ,GAAGC,YAAY;EAC9B;EACAT,MAAM,CAACU,QAAQ,GAAGA,qBAAQ;AAC5B;AAEO,MAAMD,YAAY,SAASD,qBAAQ,CAAC;EACzC;EACA,OAAOG,IAAI,CAACC,IAAS,GAAGC,SAAS,EAAEC,IAAkB,GAAG,CAAC,CAAC,EAAgB;IACxE,MAAMC,IAAI,GAAGC,IAAI,CAACC,SAAS,CAACL,IAAI,CAAC;IAEjC,IAAIG,IAAI,KAAKF,SAAS,EAAE;MACtB,MAAM,IAAIK,SAAS,CAAC,+BAA+B,CAAC;IACtD;;IAEA;IACA,MAAMC,OAAO,GAAG,KAAIf,oBAAO,EAACU,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEK,OAAO,CAAC;IAE1C,IAAI,CAACA,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC,EAAE;MAChCD,OAAO,CAACE,GAAG,CAAC,cAAc,EAAE,kBAAkB,CAAC;IACjD;IAEA,OAAO,IAAIZ,YAAY,CAACM,IAAI,EAAE;MAC5B,GAAGD,IAAI;MACPK;IACF,CAAC,CAAC;EACJ;AACF;AAAC"}